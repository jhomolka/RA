!function(a,b){"use strict";if(!a.PushStream){var d={},e=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],f=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],g=function(a){return(10>a?"0":"")+a};d.dateToUTCString=function(a){var b=g(a.getUTCHours())+":"+g(a.getUTCMinutes())+":"+g(a.getUTCSeconds());return e[a.getUTCDay()]+", "+g(a.getUTCDate())+" "+f[a.getUTCMonth()]+" "+a.getUTCFullYear()+" "+b+" GMT"};var h=function(){for(var a=arguments[0]||{},b=0;b<arguments.length;b++){var c=arguments[b];for(var d in c)(!c.hasOwnProperty||c.hasOwnProperty(d))&&(a[d]=c[d])}return a},i=/^[\],:{}\s]*$/,j=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,k=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,l=/(?:^|:|,)(?:\s*\[)+/g,m=function(a){return a.replace(/^\s*/,"").replace(/\s*$/,"")};d.parseJSON=function(b){if(!b||!t(b))return null;if(b=m(b),a.JSON&&a.JSON.parse)try{return a.JSON.parse(b)}catch(c){throw"Invalid JSON: "+b}if(i.test(b.replace(j,"@").replace(k,"]").replace(l,"")))return new Function("return "+b)();throw"Invalid JSON: "+b};var n=function(a){var b={};return b[a.tagArgument]="",b[a.timeArgument]="",b[a.eventIdArgument]="",a.messagesControlByArgument&&(b[a.tagArgument]=Number(a._etag),a._lastModified?b[a.timeArgument]=a._lastModified:a._lastEventId&&(b[a.eventIdArgument]=a._lastEventId)),b},o=function(){return(new Date).getTime()},p=function(){return{_:o()}},q=function(b){var c=b;if("object"==typeof b){c="";for(var d in b)(!b.hasOwnProperty||b.hasOwnProperty(d))&&(c+="&"+d+"="+a.escape(b[d]));c=c.substring(1)}return c||""},r=function(a,b){return a+(a.indexOf("?")<0?"?":"&")+q(b)},s=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},t=function(a){return"[object String]"===Object.prototype.toString.call(a)},u=function(a){return"[object Date]"===Object.prototype.toString.call(a)},v={logger:null,debug:function(){"debug"===N.LOG_LEVEL&&v._log.apply(v._log,arguments)},info:function(){("info"===N.LOG_LEVEL||"debug"===N.LOG_LEVEL)&&v._log.apply(v._log,arguments)},error:function(){v._log.apply(v._log,arguments)},_log:function(){if(!v.logger){var c=a.console;c&&c.log&&(c.log.apply?v.logger=c.log:"object"==typeof c.log&&Function.prototype.bind?v.logger=Function.prototype.bind.call(c.log,c):"object"==typeof c.log&&Function.prototype.call&&(v.logger=function(){Function.prototype.call.call(c.log,c,Array.prototype.slice.call(arguments))}))}v.logger&&v.logger.apply(a.console,arguments);var d=b.getElementById(N.LOG_OUTPUT_ELEMENT_ID);if(d){for(var e="",f=0;f<arguments.length;f++)e+=arguments[f]+" ";d.innerHTML+=e+"\n";var g=d.innerHTML.split("\n");g.length>100&&(d.innerHTML=g.slice(-100).join("\n"))}}},w={_getXHRObject:function(){var b=!1;try{b=new a.XMLHttpRequest}catch(c){try{b=new a.XDomainRequest}catch(d){try{b=new a.ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{b=new a.ActiveXObject("Microsoft.XMLHTTP")}catch(f){b=!1}}}}return b},_send:function(b,c){b=b||{},b.timeout=b.timeout||3e4;var d=w._getXHRObject();if(d&&b.url){w.clear(b),d.onreadystatechange=function(){4===d.readyState&&(w.clear(b),b.afterReceive&&b.afterReceive(d),200===d.status?b.success&&b.success(d.responseText):b.error&&b.error(d.status))},b.beforeOpen&&b.beforeOpen(d);var e={},f=null,g="GET";c?(f=q(b.data),g="POST"):e=b.data||{},d.open(g,r(b.url,h({},e,p())),!0),b.beforeSend&&b.beforeSend(d);var i=function(){try{d.abort()}catch(a){}w.clear(b),b.error(304)};return c?(d.setRequestHeader("Accept","application/json"),d.setRequestHeader("Content-type","application/x-www-form-urlencoded")):b.timeoutId=a.setTimeout(i,b.timeout+2e3),d.send(f),d}},_clear_script:function(a){a&&(a.onerror=a.onload=a.onreadystatechange=null,a.parentNode&&a.parentNode.removeChild(a))},_clear_timeout:function(a){a.timeoutId=E(a.timeoutId)},clear:function(a){w._clear_timeout(a),w._clear_script(b.getElementById(a.scriptId))},jsonp:function(c){c.timeout=c.timeout||3e4,w.clear(c);var d=b.head||b.getElementsByTagName("head")[0],e=b.createElement("script"),f=o(),g=function(){w.clear(c);var b=c.data.callback;b&&(a[b]=function(){a[b]=null});var d=o();c.error(d-f>c.timeout/2?304:0)},i=function(){w.clear(c),c.load()};e.onerror=g,e.onload=e.onreadystatechange=function(){(!e.readyState||/loaded|complete/.test(e.readyState))&&i()},c.beforeOpen&&c.beforeOpen({}),c.beforeSend&&c.beforeSend({}),c.timeoutId=a.setTimeout(g,c.timeout+2e3),c.scriptId=c.scriptId||o();var j=c.data.callback;return j&&(a[j]=function(){a[j]=null}),c.data.callback=c.scriptId+"_onmessage_"+o(),a[c.data.callback]=c.success,e.setAttribute("src",r(c.url,h({},c.data,p()))),e.setAttribute("async","async"),e.setAttribute("id",c.scriptId),d.insertBefore(e,d.firstChild),c},load:function(a){return w._send(a,!1)},post:function(a){return w._send(a,!0)}},x=function(b){return b?a.escape(b):""},y=function(b){return b?a.unescape(b):""};d.parseMessage=function(a,b){var c=a;t(a)&&(c=d.parseJSON(a));var e={id:c[b.jsonIdKey],channel:c[b.jsonChannelKey],text:t(c[b.jsonTextKey])?y(c[b.jsonTextKey]):c[b.jsonTextKey],tag:c[b.jsonTagKey],time:c[b.jsonTimeKey],eventid:c[b.jsonEventIdKey]||""};return e};var z=function(a){return a.backtrack?".b"+Number(a.backtrack):""},A=function(a,b){var c="";for(var d in a)(!a.hasOwnProperty||a.hasOwnProperty(d))&&(c+="/"+d+(b?z(a[d]):""));return c},B=function(a,b,c,d){var e=a.wrapper.type===I.TYPE,f=a.useSSL,g=e?f?"wss://":"ws://":f?"https://":"http://";g+=a.host,g+=!f&&80===a.port||f&&443===a.port?"":":"+a.port,g+=b;var i=A(a.channels,d);if(a.channelsByArgument){var j={};j[a.channelsArgument]=i.substring(1),c=h({},c,j)}else g+=i;return r(g,c)},C=function(a){var b="",c=a.useSSL?"https://":"http://";c+=a.host,c+=80!==a.port&&443!==a.port?":"+a.port:"",c+=a.urlPrefixPublisher;for(var d in a.channels)if(!a.channels.hasOwnProperty||a.channels.hasOwnProperty(d)){b=d;break}return c+="?id="+b};d.extract_xss_domain=function(a){if(a.match(/^(\d{1,3}\.){3}\d{1,3}$/))return a;var b=a.split("."),c=Math.max(b.length-1,a.match(/(\w{4,}\.\w{2}|\.\w{3,})$/)?2:3);return b.slice(-1*c).join(".")};var D=function(a,b){return function(){return a.apply(b,arguments)}},E=function(b){return b&&a.clearTimeout(b),null},F=function(a){v.info("["+this.type+"] message received",arguments);var b=d.parseMessage(a.data,this.pushstream);b.tag&&(this.pushstream._etag=b.tag),b.time&&(this.pushstream._lastModified=b.time),b.eventid&&(this.pushstream._lastEventId=b.eventid),this.pushstream._onmessage(b.text,b.id,b.channel,b.eventid,!0)},G=function(){this.pushstream._onopen(),v.info("["+this.type+"] connection opened")},H=function(a){v.info("["+this.type+"] error (disconnected by server):",a),(this.pushstream.readyState!==N.OPEN||this.type!==J.TYPE||"error"!==a.type||this.connection.readyState!==EventSource.CONNECTING)&&(this._closeCurrentConnection(),this.pushstream._onerror({type:a&&("load"===a.type||"close"===a.type)||this.pushstream.readyState===N.CONNECTING?"load":"timeout"}))},I=function(b){if(!a.WebSocket&&!a.MozWebSocket)throw"WebSocket not supported";this.type=I.TYPE,this.pushstream=b,this.connection=null};I.TYPE="WebSocket",I.prototype={connect:function(){this._closeCurrentConnection();var b=h({},this.pushstream.extraParams(),p(),n(this.pushstream)),c=B(this.pushstream,this.pushstream.urlPrefixWebsocket,b,!this.pushstream._useControlArguments());this.connection=a.WebSocket?new a.WebSocket(c):new a.MozWebSocket(c),this.connection.onerror=D(H,this),this.connection.onclose=D(H,this),this.connection.onopen=D(G,this),this.connection.onmessage=D(F,this),v.info("[WebSocket] connecting to:",c)},disconnect:function(){this.connection&&(v.debug("[WebSocket] closing connection to:",this.connection.URL),this.connection.onclose=null,this._closeCurrentConnection(),this.pushstream._onclose())},_closeCurrentConnection:function(){if(this.connection){try{this.connection.close()}catch(a){}this.connection=null}},sendMessage:function(a){this.connection&&this.connection.send(a)}};var J=function(b){if(!a.EventSource)throw"EventSource not supported";this.type=J.TYPE,this.pushstream=b,this.connection=null};J.TYPE="EventSource",J.prototype={connect:function(){this._closeCurrentConnection();var b=h({},this.pushstream.extraParams(),p(),n(this.pushstream)),c=B(this.pushstream,this.pushstream.urlPrefixEventsource,b,!this.pushstream._useControlArguments());this.connection=new a.EventSource(c),this.connection.onerror=D(H,this),this.connection.onopen=D(G,this),this.connection.onmessage=D(F,this),v.info("[EventSource] connecting to:",c)},disconnect:function(){this.connection&&(v.debug("[EventSource] closing connection to:",this.connection.URL),this.connection.onclose=null,this._closeCurrentConnection(),this.pushstream._onclose())},_closeCurrentConnection:function(){if(this.connection){try{this.connection.close()}catch(a){}this.connection=null}}};var K=function(a){this.type=K.TYPE,this.pushstream=a,this.connection=null,this.url=null,this.frameloadtimer=null,this.pingtimer=null,this.iframeId="PushStreamManager_"+a.id};K.TYPE="Stream",K.prototype={connect:function(){this._closeCurrentConnection();var a=d.extract_xss_domain(this.pushstream.host);try{b.domain=a}catch(c){v.error("[Stream] (warning) problem setting document.domain = "+a+" (OBS: IE8 does not support set IP numbers as domain)")}var e=h({},this.pushstream.extraParams(),p(),{streamid:this.pushstream.id},n(this.pushstream));this.url=B(this.pushstream,this.pushstream.urlPrefixStream,e,!this.pushstream._useControlArguments()),v.debug("[Stream] connecting to:",this.url),this.loadFrame(this.url)},disconnect:function(){this.connection&&(v.debug("[Stream] closing connection to:",this.url),this._closeCurrentConnection(),this.pushstream._onclose())},_clear_iframe:function(){var a=b.getElementById(this.iframeId);a&&(a.onload=null,a.src="about:blank",a.parentNode&&a.parentNode.removeChild(a))},_closeCurrentConnection:function(){this._clear_iframe(),this.connection&&(this.pingtimer=E(this.pingtimer),this.frameloadtimer=E(this.frameloadtimer),this.connection=null,this.transferDoc=null,"function"==typeof a.CollectGarbage&&a.CollectGarbage())},loadFrame:function(c){this._clear_iframe();try{var d=new a.ActiveXObject("htmlfile");d.open(),d.write('<html><script>document.domain="'+b.domain+'";</script></html>'),d.parentWindow.PushStream=N,d.close();var e=d.createElement("div");d.appendChild(e),e.innerHTML='<iframe src="'+c+'"></iframe>',this.connection=e.getElementsByTagName("IFRAME")[0],this.connection.onload=D(H,this),this.transferDoc=d}catch(f){var g=b.createElement("IFRAME");g.style.width="1px",g.style.height="1px",g.style.border="none",g.style.position="absolute",g.style.top="-10px",g.style.marginTop="-10px",g.style.zIndex="-20",g.PushStream=N,b.body.appendChild(g),g.setAttribute("src",c),g.onload=D(H,this),this.connection=g}this.connection.setAttribute("id",this.iframeId),this.frameloadtimer=a.setTimeout(D(H,this),this.pushstream.timeout)},register:function(a){this.frameloadtimer=E(this.frameloadtimer),a.p=D(this.process,this),this.connection.onload=D(this._onframeloaded,this),this.pushstream._onopen(),this.setPingTimer(),v.info("[Stream] frame registered")},process:function(a,b,c,d,e,f){this.pingtimer=E(this.pingtimer),v.info("[Stream] message received",arguments),-1!==a&&(f&&(this.pushstream._etag=f),e&&(this.pushstream._lastModified=e),d&&(this.pushstream._lastEventId=d)),this.pushstream._onmessage(y(c),a,b,d||"",!0),this.setPingTimer()},_onframeloaded:function(){v.info("[Stream] frame loaded (disconnected by server)"),this.connection.onload=null,this.disconnect()},setPingTimer:function(){this.pingtimer&&E(this.pingtimer),this.pingtimer=a.setTimeout(D(H,this),this.pushstream.pingtimeout)}};var L=function(a){this.type=L.TYPE,this.pushstream=a,this.connection=null,this.opentimer=null,this.messagesQueue=[],this._linkedInternalListen=D(this._internalListen,this),this.xhrSettings={timeout:this.pushstream.timeout,data:{},url:null,success:D(this.onmessage,this),error:D(this.onerror,this),load:D(this.onload,this),beforeSend:D(this.beforeSend,this),afterReceive:D(this.afterReceive,this)}};L.TYPE="LongPolling",L.prototype={connect:function(){this.messagesQueue=[],this._closeCurrentConnection(),this.urlWithBacktrack=B(this.pushstream,this.pushstream.urlPrefixLongpolling,{},!0),this.urlWithoutBacktrack=B(this.pushstream,this.pushstream.urlPrefixLongpolling,{},!1),this.xhrSettings.url=this.urlWithBacktrack;var b=d.extract_xss_domain(this.pushstream.host),c=d.extract_xss_domain(a.location.hostname),e=this.pushstream.port,f=a.location.port?Number(a.location.port):this.pushstream.useSSL?443:80;this.useJSONP=b!==c||e!==f||this.pushstream.useJSONP,this.xhrSettings.scriptId="PushStreamManager_"+this.pushstream.id,this.useJSONP&&(this.pushstream.messagesControlByArgument=!0),this._internalListen(),this.opentimer=a.setTimeout(D(G,this),100),v.info("[LongPolling] connecting to:",this.xhrSettings.url)},_listen:function(){this._internalListenTimeout&&E(this._internalListenTimeout),this._internalListenTimeout=a.setTimeout(this._linkedInternalListen,100)},_internalListen:function(){this.pushstream._keepConnected&&(this.xhrSettings.url=this.pushstream._useControlArguments()?this.urlWithoutBacktrack:this.urlWithBacktrack,this.xhrSettings.data=h({},this.pushstream.extraParams(),this.xhrSettings.data,n(this.pushstream)),this.useJSONP?this.connection=w.jsonp(this.xhrSettings):this.connection||(this.connection=w.load(this.xhrSettings)))},disconnect:function(){this.connection&&(v.debug("[LongPolling] closing connection to:",this.xhrSettings.url),this._closeCurrentConnection(),this.pushstream._onclose())},_closeCurrentConnection:function(){if(this.opentimer=E(this.opentimer),this.connection){try{this.connection.abort()}catch(a){try{w.clear(this.connection)}catch(a){}}this.connection=null,this.xhrSettings.url=null}},beforeSend:function(a){this.pushstream.messagesControlByArgument||(a.setRequestHeader("If-None-Match",this.pushstream._etag),a.setRequestHeader("If-Modified-Since",this.pushstream._lastModified))},afterReceive:function(a){this.pushstream.messagesControlByArgument||(this.pushstream._etag=a.getResponseHeader("Etag"),this.pushstream._lastModified=a.getResponseHeader("Last-Modified")),this.connection=null},onerror:function(a){this.pushstream._keepConnected&&(304===a?this._listen():(v.info("[LongPolling] error (disconnected by server):",a),this._closeCurrentConnection(),this.pushstream._onerror({type:403===a||this.pushstream.readyState===N.CONNECTING?"load":"timeout"})))},onload:function(){this._listen()},onmessage:function(a){this._internalListenTimeout&&E(this._internalListenTimeout),v.info("[LongPolling] message received",a);for(var b=null,c=s(a)?a:a.replace(/\}\{/g,"}\r\n{").split("\r\n"),e=0;e<c.length;e++)c[e]&&(b=d.parseMessage(c[e],this.pushstream),this.messagesQueue.push(b),this.pushstream.messagesControlByArgument&&b.time&&(this.pushstream._etag=b.tag,this.pushstream._lastModified=b.time));for(this._listen();this.messagesQueue.length>0;){var f=this.messagesQueue.shift();this.pushstream._onmessage(f.text,f.id,f.channel,f.eventid,0===this.messagesQueue.length)}}};var M=[],N=function(b){b=b||{},this.id=M.push(this)-1,this.useSSL=b.useSSL||!1,this.host=b.host||a.location.hostname,this.port=Number(b.port||(this.useSSL?443:80)),this.timeout=b.timeout||3e4,this.pingtimeout=b.pingtimeout||3e4,this.reconnectOnTimeoutInterval=b.reconnectOnTimeoutInterval||3e3,this.reconnectOnChannelUnavailableInterval=b.reconnectOnChannelUnavailableInterval||6e4,this.lastEventId=b.lastEventId||null,this.messagesPublishedAfter=b.messagesPublishedAfter,this.messagesControlByArgument=b.messagesControlByArgument||!1,this.tagArgument=b.tagArgument||"tag",this.timeArgument=b.timeArgument||"time",this.eventIdArgument=b.eventIdArgument||"eventid",this.useJSONP=b.useJSONP||!1,this._reconnecttimer=null,this._etag=0,this._lastModified=null,this._lastEventId=null,this.urlPrefixPublisher=b.urlPrefixPublisher||"/pub",this.urlPrefixStream=b.urlPrefixStream||"/sub",this.urlPrefixEventsource=b.urlPrefixEventsource||"/ev",this.urlPrefixLongpolling=b.urlPrefixLongpolling||"/lp",this.urlPrefixWebsocket=b.urlPrefixWebsocket||"/ws",this.jsonIdKey=b.jsonIdKey||"id",this.jsonChannelKey=b.jsonChannelKey||"channel",this.jsonTextKey=b.jsonTextKey||"text",this.jsonTagKey=b.jsonTagKey||"tag",this.jsonTimeKey=b.jsonTimeKey||"time",this.jsonEventIdKey=b.jsonEventIdKey||"eventid",this.modes=(b.modes||"eventsource|websocket|stream|longpolling").split("|"),this.wrappers=[],this.wrapper=null,this.onchanneldeleted=b.onchanneldeleted||null,this.onmessage=b.onmessage||null,this.onerror=b.onerror||null,this.onstatuschange=b.onstatuschange||null,this.extraParams=b.extraParams||function(){return{}},this.channels={},this.channelsCount=0,this.channelsByArgument=b.channelsByArgument||!1,this.channelsArgument=b.channelsArgument||"channels";for(var c=0;c<this.modes.length;c++)try{var d=null;switch(this.modes[c]){case"websocket":d=new I(this);break;case"eventsource":d=new J(this);break;case"longpolling":d=new L(this);break;case"stream":d=new K(this)}this.wrappers[this.wrappers.length]=d}catch(e){v.info(e)}this.readyState=0};N.LOG_LEVEL="error",N.LOG_OUTPUT_ELEMENT_ID="Log4jsLogOutput",N.CLOSED=0,N.CONNECTING=1,N.OPEN=2,N.prototype={addChannel:function(a,b){if(x(a)!==a)throw"Invalid channel name! Channel has to be a set of [a-zA-Z0-9]";if(v.debug("entering addChannel"),"undefined"!=typeof this.channels[a])throw"Cannot add channel "+a+": already subscribed";b=b||{},v.info("adding channel",a,b),this.channels[a]=b,this.channelsCount++,this.readyState!==N.CLOSED&&this.connect(),v.debug("leaving addChannel")},removeChannel:function(a){this.channels[a]&&(v.info("removing channel",a),delete this.channels[a],this.channelsCount--)},removeAllChannels:function(){v.info("removing all channels"),this.channels={},this.channelsCount=0},_setState:function(a){this.readyState!==a&&(v.info("status changed",a),this.readyState=a,this.onstatuschange&&this.onstatuschange(this.readyState))},connect:function(){if(v.debug("entering connect"),!this.host)throw"PushStream host not specified";if(isNaN(this.port))throw"PushStream port not specified";if(!this.channelsCount)throw"No channels specified";if(0===this.wrappers.length)throw"No available support for this browser";this._keepConnected=!0,this._lastUsedMode=0,this._connect(),v.debug("leaving connect")},disconnect:function(){v.debug("entering disconnect"),this._keepConnected=!1,this._disconnect(),this._setState(N.CLOSED),v.info("disconnected"),v.debug("leaving disconnect")},_useControlArguments:function(){return this.messagesControlByArgument&&(null!==this._lastModified||null!==this._lastEventId)},_connect:function(){if(null===this._lastEventId&&(this._lastEventId=this.lastEventId),null===this._lastModified){var a=this.messagesPublishedAfter;if(!u(a)){var b=Number(this.messagesPublishedAfter);b>0?(a=new Date,a.setTime(a.getTime()-1e3*b)):0>b&&(a=new Date(0))}u(a)&&(this._lastModified=d.dateToUTCString(a))}this._disconnect(),this._setState(N.CONNECTING),this.wrapper=this.wrappers[this._lastUsedMode++%this.wrappers.length];try{this.wrapper.connect()}catch(c){this.wrapper&&this.wrapper.disconnect()}},_disconnect:function(){this._reconnecttimer=E(this._reconnecttimer),this.wrapper&&this.wrapper.disconnect()},_onopen:function(){this._reconnecttimer=E(this._reconnecttimer),this._setState(N.OPEN),this._lastUsedMode>0&&this._lastUsedMode--},_onclose:function(){this._reconnecttimer=E(this._reconnecttimer),this._setState(N.CLOSED),this._reconnect(this.reconnectOnTimeoutInterval)},_onmessage:function(a,b,c,d,e){v.debug("message",a,b,c,d,e),-2===b?this.onchanneldeleted&&this.onchanneldeleted(c):b>0&&this.onmessage&&this.onmessage(a,b,c,d,e)},_onerror:function(a){this._setState(N.CLOSED),this._reconnect("timeout"===a.type?this.reconnectOnTimeoutInterval:this.reconnectOnChannelUnavailableInterval),this.onerror&&this.onerror(a)},_reconnect:function(b){this._keepConnected&&!this._reconnecttimer&&this.readyState!==N.CONNECTING&&(v.info("trying to reconnect in",b),this._reconnecttimer=a.setTimeout(D(this._connect,this),b))},sendMessage:function(a,b,c){a=x(a),this.wrapper.type===I.TYPE?(this.wrapper.sendMessage(a),b&&b()):w.post({url:C(this),data:a,success:b,error:c})}},N.sendMessage=function(a,b,c,d){w.post({url:a,data:x(b),success:c,error:d})},N.register=function(a){var b=a.window.location.href.match(/streamid=([0-9]*)&?/);b[1]&&M[b[1]]&&M[b[1]].wrapper.register(a)},N.unload=function(){for(var a=0;a<M.length;a++)try{M[a].disconnect()}catch(b){}},a.PushStream=N,a.PushStreamManager=M,a.attachEvent&&a.attachEvent("onunload",N.unload),a.addEventListener&&a.addEventListener.call(a,"unload",N.unload,!1)}}(window,document);